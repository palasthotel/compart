{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/features/user-proposal-form.js","webpack:///./src/features/voting.js","webpack:///./src/public-app.js","webpack:///./src/public-app.scss?2c74"],"names":["jQuery","$","api","Compart","selectComponent","selectSuccess","selectError","on","e","preventDefault","$form","$component","parent","attr","$proposal","find","proposal","val","length","prop","createProposal","then","response","onResult","hide","success","show","$success","$findProposals","$voting","$findProposal","proposalId","setIsVoted","unsetIsVoted","removeAttr","isVoted","getProposalId","getReactionsCount","parseInt","setReactionsCount","count","incrementReactionsCount","by","updateVotingState","proposalIds","each","index","el","forEach","initVoting","votingId","data","myReactions","queryVoting","map","r","$el","_isVoted","unvoteForProposal","voteForProposal","console","error"],"mappings":"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","file":"public-app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/public-app.js\");\n","jQuery(($) => {\n\n    const api = Compart.api;\n\n    const selectComponent = \"[data-compart-user-proposal-form]\";\n    const selectSuccess = \"[data-compart-proposal-success]\";\n    const selectError = \"[data-compart-proposal-error]\";\n\n    $(\"body\").on(\"submit\", `${selectComponent} form`, function (e) {\n        e.preventDefault();\n        const $form = $(this);\n        const $component = $form.parent(selectComponent);\n\n        if ($component.attr(\"data-is-submitting\") === \"true\") return;\n\n        const $proposal = $form.find(\"[name=compart_proposal]\");\n        const proposal = $proposal.val();\n\n        if (typeof proposal !== \"string\" || proposal.length <= 0) {\n            return;\n        }\n\n        $proposal.prop(\"disabled\", true);\n        $component.attr(\"data-is-submitting\", \"true\");\n\n        api.createProposal(proposal)\n            .then(response => {\n                $proposal.prop(\"disabled\", false);\n                $component.attr(\"data-is-submitting\", \"false\");\n                $proposal.val(\"\");\n                return response;\n            }).then(onResult($component, proposal));\n    });\n\n    const onResult = ($component, proposal) => (response) => {\n        $component.find(\"form\").hide();\n        if (!response.success) {\n            $component.find(selectError).show();\n            return;\n        }\n        const $success = $component.find(selectSuccess);\n        $success.show();\n        $success.find(\"[data-compart-proposal-preview]\").val(proposal);\n    }\n});","jQuery(($) => {\n\n    const api = Compart.api;\n\n    const $findProposals = ($voting) => $voting.find(\"[data-proposal-id]\");\n    const $findProposal = ($voting, proposalId) => $voting.find(\"[data-proposal-id=\" + proposalId + \"]\");\n    const setIsVoted = ($proposal) => $proposal.attr(\"data-is-voted\", true);\n    const unsetIsVoted = ($proposal) => $proposal.removeAttr(\"data-is-voted\");\n    const isVoted = ($proposal) => $proposal.attr(\"data-is-voted\") === \"true\";\n    const getProposalId = ($proposal) => $proposal.attr(\"data-proposal-id\");\n    const getReactionsCount = ($proposal) => parseInt($proposal.attr(\"data-reactions-count\"));\n    const setReactionsCount = ($proposal, count) => $proposal.attr(\"data-reactions-count\", count);\n    const incrementReactionsCount = ($proposal, by = 1) => {\n        const count = getReactionsCount($proposal);\n        setReactionsCount($proposal, count + by);\n    }\n\n    const updateVotingState = ($voting, proposalIds) => {\n        $findProposals($voting).each((index, el) => {\n            const $proposal = $(el);\n            if (isVoted($proposal)) {\n                unsetIsVoted($proposal);\n                incrementReactionsCount($proposal, -1);\n            }\n        });\n        proposalIds.forEach((proposalId) => {\n            const $proposal = $findProposal($voting, proposalId);\n            setIsVoted($proposal);\n            incrementReactionsCount($proposal)\n        });\n    }\n\n    async function initVoting($voting) {\n        const votingId = $voting.data(\"voting-id\");\n\n        const myReactions = await api.queryVoting(votingId);\n        updateVotingState($voting, myReactions.map(r => r.proposalId));\n\n        $voting.on(\"click\", \"[data-proposal-id]\", async function(e){\n            const $el = $(this);\n            const proposalId = getProposalId($el);\n            const _isVoted = isVoted($el);\n            if (_isVoted) {\n                await api.unvoteForProposal(votingId, proposalId);\n            } else {\n                await api.voteForProposal(votingId, proposalId, \"up\")\n            }\n            updateVotingState($voting, _isVoted ? [] : [proposalId]);\n        });\n    }\n\n    // ----------------------------------------------------\n    // init applications\n    // ----------------------------------------------------\n    $(\"[data-voting-id]\").each(async (index, el) => {\n        try {\n            await initVoting($(el));\n        } catch (e) {\n            console.error(e);\n        }\n    });\n});","import './public-app.scss';\nimport './features/user-proposal-form.js';\nimport './features/voting.js';\n","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}